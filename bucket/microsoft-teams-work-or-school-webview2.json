{
   "$schema": "https://raw.githubusercontent.com/lukesampson/scoop/master/schema.json",
   "version": "26032.208.4399.5",
   "description": "Proprietary business communication platform developed by Microsoft",
   "homepage": "https://adoption.microsoft.com/new-microsoft-teams/",
   "license": {
      "identifier": "Proprietary"
   },
   "architecture": {
      "32bit": {
         "url": "https://statics.teams.cdn.office.net/production-windows-x86/26032.208.4399.5/MSTeams-x86.msix#/dl.zip",
         "hash": "8a2a4f5ea7c553f58dc89274a07e965d393ab9ab5699d3fd52e55403e5f998b9"
      },
      "64bit": {
         "url": "https://statics.teams.cdn.office.net/production-windows-x64/26032.208.4399.5/MSTeams-x64.msix#/dl.zip",
         "hash": "d485c30215f76e679860b1281157a2714a6242771f0a2944547adccd25083345"
      },
      "arm64": {
         "url": "https://statics.teams.cdn.office.net/production-windows-arm64/26032.208.4399.5/MSTeams-arm64.msix#/dl.zip",
         "hash": "dca05df266fe018463eaa5061fb2d80ae477c66327dcaea08267bb10113618c4"
      }
   },
   "installer": {
      "script": [
         "if ((Get-ItemPropertyValue -Path 'Registry::HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock' -Name AllowDevelopmentWithoutDevLicense) -eq 1) { $AppModelUnlocked = $true }",
         "if (-not $AppModelUnlocked) {",
         "   if (-not (is_admin)) { abort 'This package requires admin privileges to install' }",
         "   New-ItemProperty -Force -Path 'Registry::HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock' -Name 'AllowDevelopmentWithoutDevLicense' -PropertyType DWord -Value '1' > $null",
         "}",
         "if ($PSVersionTable.PSVersion.Major -ge 6) { Import-Module Appx -UseWindowsPowershell 3>$null }",
         "Add-AppxPackage -Path \"$dir\\AppxManifest.xml\" -Register",
         "@(",
         "   'Set SHL = CreateObject(\"WScript.Shell\")'",
         "   \"call SHL.Run(`\"$env:LocalAppData\\Microsoft\\WindowsApps\\ms-teams.exe`\", o, false)\"",
         ") | Set-Content -Path \"$dir\\ms-teams.vbs\"",
         "if (-not $AppModelUnlocked) {",
         "   Remove-ItemProperty -Force -Path 'Registry::HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock' -Name 'AllowDevelopmentWithoutDevLicense'",
         "}"
      ]
   },
   "uninstaller": {
      "script": [
         "if ($PSVersionTable.PSVersion.Major -ge 6) { Import-Module Appx -UseWindowsPowershell 3>$null }",
         "if ($purge) {",
         "   Get-AppxPackage -Name MSTeams | Remove-AppxPackage",
         "} else {",
         "   Get-AppxPackage -Name MSTeams | Remove-AppxPackage -PreserveApplicationData",
         "}"
      ]
   },
   "shortcuts": [
      [
         "ms-teams.vbs",
         "Microsoft Teams (work or school) (WebView2)",
         "",
         "ms-teams.exe"
      ]
   ],
   "checkver": {
      "url": "https://config.teams.microsoft.com/config/v1/MicrosoftTeams/1415_1.0.0.0?environment=prod&audienceGroup=general&teamsRing=general&agent=TeamsBuilds",
      "jsonpath": "$.BuildSettings.WebView2Canary.x64.latestVersion"
   },
   "autoupdate": {
      "architecture": {
         "32bit": {
            "url": "https://statics.teams.cdn.office.net/production-windows-x86/$version/MSTeams-x86.msix#/dl.zip"
         },
         "64bit": {
            "url": "https://statics.teams.cdn.office.net/production-windows-x64/$version/MSTeams-x64.msix#/dl.zip"
         },
         "arm64": {
            "url": "https://statics.teams.cdn.office.net/production-windows-arm64/$version/MSTeams-arm64.msix#/dl.zip"
         }
      }
   }
}
