{
   "$schema": "https://raw.githubusercontent.com/lukesampson/scoop/master/schema.json",
   "version": "1.7.00.1864",
   "description": "Proprietary business communication platform developed by Microsoft",
   "homepage": "https://teams.com/",
   "license": {
      "identifier": "Proprietary"
   },
   "notes": [
      "Apps in `current` won't work, use the version folder instead.",
      "Start Microsoft Teams (work or school) with Windows by running:",
      ".\"$dir\\add-startup.ps1\""
   ],
   "architecture": {
      "32bit": {
         "url": "https://statics.teams.cdn.office.net/production-windows/1.7.00.1864/Teams_windows.exe#/dl.exe",
         "hash": "c60919f4c672f1424affef8d49e0131d7f22833e2d0319a56863ac34874b13d6"
      },
      "64bit": {
         "url": "https://statics.teams.cdn.office.net/production-windows-x64/1.7.00.1864/Teams_windows_x64.exe#/dl.exe",
         "hash": "f47b2392e2c323c1066709f7b754c607ba72c70727ee95e4810f156f260b1342"
      },
      "arm64": {
         "url": "https://statics.teams.cdn.office.net/production-windows-arm64/1.7.00.1864/Teams_windows_arm64.exe#/dl.exe",
         "hash": "81fd1f60d9a29f90103247c2ea8905f474ae2b422bfe87b1ddfccb03ca5bc2d1"
      }
   },
   "installer": {
      "script": [
         "Expand-7zipArchive -Path \"$dir\\dl.exe\" -DestinationPath \"$dir\\_tmp\" -Removal",
         "Expand-7zipArchive -Path \"$dir\\_tmp\\Teams-$version-full.nupkg\" -ExtractDir 'lib/net45' -DestinationPath \"$dir\"",
         "Remove-Item -Path \"$dir\\_tmp\" -Recurse -Force",
         "$exepath = \"$dir\\Teams.exe\"",
         "startmenu_shortcut $exepath 'Microsoft Teams (work or school)' '' $null $global",
         "$registryPath = 'Registry::HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run'",
         "if ($global) {",
         "   $registryPath = $registryPath.Replace('HKCU', 'HKLM')",
         "}",
         "@(",
         "   \"New-Item -Path '$registryPath' > `$null 2>&1\"",
         "   \"New-ItemProperty -Force -Path '$registryPath' -Name 'Microsoft Teams (work or school)' -PropertyType String -Value '$exepath' > `$null\"",
         ") | Set-Content -Path \"$dir\\add-startup.ps1\"",
         "@(",
         "   \"Remove-ItemProperty -Force -Path '$registryPath' -Name 'Microsoft Teams (work or school)' > `$null\"",
         ") | Set-Content -Path \"$dir\\remove-startup.ps1\""
      ]
   },
   "uninstaller": {
      "script": [
         "if ($cmd -eq 'uninstall') {",
         "   Remove-Item \"$(shortcut_folder $global)\\Microsoft Teams (work or school).lnk\" -Force",
         "   .\"$dir\\remove-startup.ps1\"",
         "}"
      ]
   },
   "checkver": {
      "url": "https://config.teams.microsoft.com/config/v1/MicrosoftTeams/1415_1.0.0.0?environment=prod&audienceGroup=general&teamsRing=general&agent=TeamsBuilds",
      "jsonpath": "$.BuildSettings.Desktop.windows64.latestVersion"
   },
   "autoupdate": {
      "architecture": {
         "32bit": {
            "url": "https://statics.teams.cdn.office.net/production-windows/$version/Teams_windows.exe#/dl.exe"
         },
         "64bit": {
            "url": "https://statics.teams.cdn.office.net/production-windows-x64/$version/Teams_windows_x64.exe#/dl.exe"
         },
         "arm64": {
            "url": "https://statics.teams.cdn.office.net/production-windows-arm64/$version/Teams_windows_arm64.exe#/dl.exe"
         }
      }
   }
}
