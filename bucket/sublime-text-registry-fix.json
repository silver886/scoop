{
    "version": "1.0.0",
    "description": "Fix Sublime Text registry. This will always open Sublime Text in new window and set Sublime Text as default editor and replace notepad.exe.",
    "depends": "extras/sublime-text",
    "url": "https://raw.githubusercontent.com/silver886/scoop-silver886/master/scripts/sublime-text-registry-fix/sublime-text-notepad.bat",
    "hash": "95a121240873f84fa3a0da26436f6590cb2df6387fc810debedcde10fcf1acaa",
    "installer": {
        "script": [
            "$sublime = \"$scoopdir\\apps\\sublime-text\\current\\sublime_text.exe\"",
            "$registryPath = 'Registry::HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Notepad.exe'",
            "$sublimeBat = \"$dir\\sublime-text-notepad.bat\"",
            "$content = (Get-Content $sublimeBat).Replace('$sublime', $sublime)",
            "Set-Content -Force -Path $sublimeBat -Value $content -Encoding Ascii",
            "New-Item -Force -Path \"$registryPath\"",
            "New-ItemProperty -Force -Path \"$registryPath\" -Name 'Debugger' -Value \"`\"$sublimeBat`\"\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\*\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" -n `\"%1`\"\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\Directory\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" -n `\"%1`\"\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\Directory\\Background\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" -n `\"%V`\"\""
        ]
    },
    "uninstaller": {
        "script": [
            "$sublime = \"$scoopdir\\apps\\sublime-text\\current\\sublime_text.exe\"",
            "$registryPath = 'Registry::HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Notepad.exe'",
            "Remove-Item -Force -Recurse -Path \"$registryPath\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\*\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" '%1'\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\Directory\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" '%1'\"",
            "$registryPath = 'Registry::HKCU\\Software\\Classes\\Directory\\Background\\shell\\Open with &Sublime\\command'",
            "Set-Item -Force -Path \"$registryPath\" -Value \"`\"$sublime`\" '%V'\""
        ]
    }
}
